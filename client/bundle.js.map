{"version":3,"sources":["webpack:///webpack/bootstrap f606ec227d762ce54e03","webpack:///./client/js/game.js","webpack:///./~/eventemitter3/index.js","webpack:///./client/js/setup.js","webpack:///./client/js/core/createOnResizeHandler.js","webpack:///./client/js/gui/createGoFullscreenButton.js","webpack:///./client/js/core/createKeyboardMappings.js","webpack:///./~/cb-hyperion/lib/hyperion.js","webpack:///./~/cb-hyperion/~/cb-multiobserve/lib/multiobserve.js","webpack:///./~/cb-hyperion/lib/message-validator.js","webpack:///./~/cb-hyperion/lib/object-store.js","webpack:///./~/cb-hyperion/lib/guid.js","webpack:///./~/cb-hyperion/lib/createHyperionClient.js","webpack:///./~/cb-hyperion/lib/createChangeHandler.js","webpack:///./client/js/core/createBoard.js","webpack:///./client/js/core/createPlayer.js","webpack:///./client/js/core/createTargetPointer.js","webpack:///./client/js/console/createConsole.js","webpack:///./client/js/editor/createEditor.js","webpack:///./client/js/editor/createEditorIcon.js","webpack:///./client/js/editor/createTileSetPalette.js","webpack:///./client/js/console/createInterpreter.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA,UAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,MAAK;AACL,EAAC;;;;;;;;ACrJD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAW,SAAS;AACpB,YAAW,MAAM;AACjB,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;;AAEzB;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,QAAQ;AACnB,cAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2DAA0D,OAAO;AACjE;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB,cAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0CAAyC,SAAS;AAClD;AACA;;AAEA;AACA,IAAG;AACH;AACA;;AAEA,gBAAe,YAAY;AAC3B;;AAEA;AACA,4DAA2D;AAC3D,gEAA+D;AAC/D,oEAAmE;AACnE;AACA,2DAA0D,SAAS;AACnE;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,QAAQ;AACnB,YAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;;AAEA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,SAAS;AACpB,YAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;;AAEA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,SAAS;AACpB,YAAW,MAAM;AACjB,YAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,iDAAgD,YAAY;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA,kCAAiC;;AAEjC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACrQA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT,wCAAuC;AACvC;;AAEA;AACA;AACA;AACA,MAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA,4BAA2B,YAAY;AACvC,gCAA+B,WAAW;AAC1C;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACpFA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,E;;;;;;ACpCA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,E;;;;;;ACrCA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,E;;;;;;ACxCA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;AACb;AACA;AACA,cAAa;AACb;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;AACb;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,cAAa;AACb;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA,MAAK;;;AAGL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,MAAK;AACL,E;;;;;;AC3JA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,+CAA8C;AAC9C;AACA,cAAa;AACb;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,wHAAuH;AACvH,iFAAgF;AAChF;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA,kBAAiB;AACjB;;AAEA;AACA,UAAS;AACT,MAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA,mDAAkD;AAClD;AACA;AACA,UAAS;AACT,mDAAkD;AAClD;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA,gDAA+C;AAC/C;AACA;AACA,UAAS;AACT,gDAA+C;AAC/C;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;AACb;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,UAAS;AACT;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,E;;;;;;AC7RA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,E;;;;;;ACrCA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,wCAAuC;;AAEvC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,c;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA,E;;;;;;ACpIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E;;;;;;ACRA;;AAEA;;AAEA;AACA;AACA,2CAA0C;AAC1C,0CAAyC;AACzC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;AACjB;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,E;;;;;;ACxKA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA,E;;;;;;AC3EA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA,MAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACvIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,E;;;;;;AC1DA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,kCAAiC,2BAA2B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,E;;;;;;ACtIA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,6BAA4B,IAAI;AAChC,wCAAuC,uDAAuD;AAC9F;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,iBAAiB;AACpC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,gBAAgB;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;;AAEL;;;AAGA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;;AAEL;AACA,kCAAiC,KAAK;AACtC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;;AAEA,UAAS;AACT;;AAEA;AACA;AACA;;;;;;;;ACxIA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,2CAA0C,iBAAiB,IAAI,6CAA6C,KAAK,8CAA8C;AAC/J,UAAS,uDAAuD;AAChE;AACA;AACA;;AAEA,iDAAgD,uDAAuD;AACvG;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,oCAAmC,iBAAiB,IAAI,6CAA6C,KAAK,8CAA8C;AACxJ;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,oCAAmC,iBAAiB,IAAI,6CAA6C,KAAK,8CAA8C;AACxJ;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,cAAa;AACb;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;AACb;AACA,MAAK;;AAEL,E;;;;;;AC5YA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;;AAEL;;;AAGA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,E;;;;;;AC1DA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,iBAAgB,gBAAgB;AAChC;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,E;;;;;;ACxGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA,2DAA0D,iDAAiD;AAC3G;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA0D,KAAK;AAC/D,cAAa;AACb;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;AACb;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,gCAA+B,YAAY;AAC3C;AACA;AACA","file":"./client/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap f606ec227d762ce54e03\n **/","'use strict'\r\n/*global PIXI */\r\n\r\nconst EventEmitter = require('eventemitter3');\r\nconst setupGame = require('./setup')\r\nconst createKeyboardMappings = require('./core/createKeyboardMappings')\r\nconst createHyperionClient = require('cb-hyperion').createHyperionClient\r\nconst createBoard = require('./core/createBoard')\r\nconst createPlayer = require('./core/createPlayer')\r\nconst createTargetPointer = require('./core/createTargetPointer')\r\nconst createConsole = require('./console/createConsole')\r\nconst createEditor = require('./editor/createEditor')\r\nconst createInterpreter = require('./console/createInterpreter')\r\n\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n\r\n    const debug = true\r\n    const init = (graphicsCtx) => {\r\n        let client = createHyperionClient({\r\n            host: 'ws://' + location.host\r\n        })\r\n\r\n        const emiter = new EventEmitter()\r\n\r\n        createKeyboardMappings({\r\n            emiter: emiter\r\n        })\r\n\r\n        client.then((clientCtx) => {\r\n            const board = createBoard({\r\n                clientCtx : clientCtx,\r\n                graphicsCtx : graphicsCtx,\r\n                emiter : emiter,\r\n                parent : graphicsCtx.stage\r\n            })\r\n\r\n            createTargetPointer({\r\n                clientCtx : clientCtx,\r\n                graphicsCtx : graphicsCtx,\r\n                emiter : emiter,\r\n                name : 'aPlayer',\r\n                parent : board.container()\r\n            })\r\n\r\n            createTargetPointer({\r\n                clientCtx : clientCtx,\r\n                graphicsCtx : graphicsCtx,\r\n                emiter : emiter,\r\n                name : 'bPlayer',\r\n                parent : board.container()\r\n            })\r\n\r\n            createPlayer({\r\n                clientCtx : clientCtx,\r\n                graphicsCtx : graphicsCtx,\r\n                emiter : emiter,\r\n                name : 'aPlayer',\r\n                parent : board.container()\r\n            })\r\n\r\n            createPlayer({\r\n                clientCtx : clientCtx,\r\n                graphicsCtx : graphicsCtx,\r\n                emiter : emiter,\r\n                name : 'bPlayer',\r\n                parent : board.container()\r\n            })\r\n\r\n            const guiConsole = createConsole({\r\n                graphicsCtx : graphicsCtx,\r\n                emiter : emiter\r\n            })\r\n\r\n            const interpreter = createInterpreter({\r\n                clientCtx: clientCtx\r\n            })\r\n\r\n            guiConsole.setInputListener((command)=>{\r\n                const result = interpreter.interpret(command)\r\n                if(result instanceof Promise){\r\n                    result.then((r)=>{\r\n                        guiConsole.writeLine(r)\r\n                    })\r\n                } else {\r\n                    guiConsole.writeLine(result)\r\n                }\r\n            })\r\n\r\n            const editor = createEditor({\r\n                graphicsCtx : graphicsCtx,\r\n                clientCtx : clientCtx,\r\n                emiter : emiter\r\n            })\r\n        },(error)=>{\r\n            console.log(error)\r\n        })\r\n    }\r\n\r\n    const update = (delta)=> {\r\n        //assets.bunny.rotation += (delta/1000)\r\n    }\r\n\r\n    setupGame({\r\n        assets: [\r\n            {\r\n                name: 'floor',\r\n                url: '/assets/img/Objects/Floor.png'\r\n            },\r\n            {\r\n                name: 'debug',\r\n                url: '/assets/img/Development/debug.png'\r\n            },\r\n            {\r\n                name: 'wall',\r\n                url: '/assets/img/Objects/Wall.png'\r\n            },\r\n            {\r\n                name: 'warrior',\r\n                url: '/assets/img/Commissions/Warrior.png'\r\n            },\r\n            {\r\n                name: 'editor',\r\n                url: '/assets/img/Editor/EditorControls.png'\r\n            },\r\n            {\r\n                name: 'mage',\r\n                url: '/assets/img/Commissions/Mage.png'\r\n            },\r\n            {\r\n                name: 'walking',\r\n                url: '/assets/img/Other/Walking.png'\r\n            },\r\n            {\r\n                name: 'tile',\r\n                url: '/assets/img/Objects/Tile.png'\r\n            },\r\n            {\r\n                name: 'fogofwar',\r\n                url: '/assets/img/Other/FogOfWar.png'\r\n            }\r\n        ],\r\n        init: init,\r\n        update: update,\r\n        viewport: {\r\n            width: 1920,\r\n            height: 1080\r\n        },\r\n        scale: 3\r\n    })\r\n});\r\n\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/game.js\n ** module id = 0\n ** module chunks = 0\n **/","'use strict';\n\n//\n// We store our EE objects in a plain object whose properties are event names.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// `~` to make sure that the built-in object properties are not overridden or\n// used as an attack vector.\n// We also assume that `Object.create(null)` is available when the event name\n// is an ES6 Symbol.\n//\nvar prefix = typeof Object.create !== 'function' ? '~' : false;\n\n/**\n * Representation of a single EventEmitter function.\n *\n * @param {Function} fn Event handler to be called.\n * @param {Mixed} context Context for function execution.\n * @param {Boolean} once Only emit once\n * @api private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Minimal EventEmitter interface that is molded against the Node.js\n * EventEmitter interface.\n *\n * @constructor\n * @api public\n */\nfunction EventEmitter() { /* Nothing to set */ }\n\n/**\n * Holds the assigned EventEmitters by name.\n *\n * @type {Object}\n * @private\n */\nEventEmitter.prototype._events = undefined;\n\n/**\n * Return a list of assigned event listeners.\n *\n * @param {String} event The events that should be listed.\n * @param {Boolean} exists We only need to know if there are listeners.\n * @returns {Array|Boolean}\n * @api public\n */\nEventEmitter.prototype.listeners = function listeners(event, exists) {\n  var evt = prefix ? prefix + event : event\n    , available = this._events && this._events[evt];\n\n  if (exists) return !!available;\n  if (!available) return [];\n  if (available.fn) return [available.fn];\n\n  for (var i = 0, l = available.length, ee = new Array(l); i < l; i++) {\n    ee[i] = available[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Emit an event to all registered event listeners.\n *\n * @param {String} event The name of the event.\n * @returns {Boolean} Indication if we've emitted an event.\n * @api public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events || !this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if ('function' === typeof listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Register a new EventListener for the given event.\n *\n * @param {String} event Name of the event.\n * @param {Functon} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @api public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  var listener = new EE(fn, context || this)\n    , evt = prefix ? prefix + event : event;\n\n  if (!this._events) this._events = prefix ? {} : Object.create(null);\n  if (!this._events[evt]) this._events[evt] = listener;\n  else {\n    if (!this._events[evt].fn) this._events[evt].push(listener);\n    else this._events[evt] = [\n      this._events[evt], listener\n    ];\n  }\n\n  return this;\n};\n\n/**\n * Add an EventListener that's only called once.\n *\n * @param {String} event Name of the event.\n * @param {Function} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @api public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  var listener = new EE(fn, context || this, true)\n    , evt = prefix ? prefix + event : event;\n\n  if (!this._events) this._events = prefix ? {} : Object.create(null);\n  if (!this._events[evt]) this._events[evt] = listener;\n  else {\n    if (!this._events[evt].fn) this._events[evt].push(listener);\n    else this._events[evt] = [\n      this._events[evt], listener\n    ];\n  }\n\n  return this;\n};\n\n/**\n * Remove event listeners.\n *\n * @param {String} event The event we want to remove.\n * @param {Function} fn The listener that we need to find.\n * @param {Mixed} context Only remove listeners matching this context.\n * @param {Boolean} once Only remove once listeners.\n * @api public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events || !this._events[evt]) return this;\n\n  var listeners = this._events[evt]\n    , events = [];\n\n  if (fn) {\n    if (listeners.fn) {\n      if (\n           listeners.fn !== fn\n        || (once && !listeners.once)\n        || (context && listeners.context !== context)\n      ) {\n        events.push(listeners);\n      }\n    } else {\n      for (var i = 0, length = listeners.length; i < length; i++) {\n        if (\n             listeners[i].fn !== fn\n          || (once && !listeners[i].once)\n          || (context && listeners[i].context !== context)\n        ) {\n          events.push(listeners[i]);\n        }\n      }\n    }\n  }\n\n  //\n  // Reset the array, or remove it completely if we have no more listeners.\n  //\n  if (events.length) {\n    this._events[evt] = events.length === 1 ? events[0] : events;\n  } else {\n    delete this._events[evt];\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners or only the listeners for the specified event.\n *\n * @param {String} event The event want to remove all listeners for.\n * @api public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  if (!this._events) return this;\n\n  if (event) delete this._events[prefix ? prefix + event : event];\n  else this._events = prefix ? {} : Object.create(null);\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// This function doesn't apply anymore.\n//\nEventEmitter.prototype.setMaxListeners = function setMaxListeners() {\n  return this;\n};\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/eventemitter3/index.js\n ** module id = 1\n ** module chunks = 0\n **/","'use strict'\r\n/*global PIXI */\r\n\r\nconst createOnResizeHandler = require('./core/createOnResizeHandler')\r\nconst createGoFullscreenButton = require('./gui/createGoFullscreenButton')\r\n\r\nmodule.exports = function setup(spec) {\r\n\r\n    const assets = spec.assets || []\r\n    const initCb = spec.init || (()=> {\r\n        })\r\n    const updateCb = spec.update || (()=> {\r\n        })\r\n    const viewport = spec.viewport || {width: 1920, height: 1080}\r\n    const scale = spec.scale\r\n\r\n    const ratio = viewport.width / viewport.height\r\n    const renderer = new PIXI.autoDetectRenderer(viewport.width, viewport.height, {\r\n        antialias: false\r\n    })\r\n    PIXI.SCALE_MODES.DEFAULT = PIXI.SCALE_MODES.NEAREST\r\n\r\n    const stage = new PIXI.Container()\r\n\r\n    stage.scale.x = scale\r\n    stage.scale.y = scale\r\n    stage.position.x = 0\r\n    stage.position.y = 0\r\n\r\n    document.body.appendChild(renderer.view)\r\n    /*document.body.appendChild(createGoFullscreenButton({\r\n        canvas: renderer.view\r\n    }))*/\r\n\r\n    window.onresize = createOnResizeHandler({\r\n        canvas: renderer.view,\r\n        ratio: ratio\r\n    })\r\n\r\n    assets.forEach((el)=> {\r\n        PIXI.loader.add(el.name, el.url)\r\n    })\r\n\r\n    PIXI.loader\r\n        .on('progress', function (loader, loadedResource) {\r\n            console.log('Progress:', loader.progress + '%');\r\n        })\r\n        .after(function (resource, next) {\r\n            resource.frameWidth = 16\r\n            resource.frameHeight = 16\r\n            resource.frames = []\r\n\r\n            const height = resource.texture.height - (resource.texture.height%resource.frameHeight === 0 ? 0:resource.frameHeight)\r\n            const width = resource.texture.width - (resource.texture.width%resource.frameHeight === 0 ? 0:resource.frameHeight)\r\n\r\n            for (let y = 0; y < height; y += resource.frameHeight) {\r\n                for (let x = 0; x < width; x += resource.frameWidth) {\r\n                    resource.frames.push(new PIXI.Texture(resource.texture.baseTexture, new PIXI.Rectangle(x, y, resource.frameWidth, resource.frameHeight)));\r\n                }\r\n            }\r\n            next()\r\n        })\r\n        .load(function (loader, resources) {\r\n            initCb({\r\n                stage : stage,\r\n                resources : resources,\r\n                renderer : renderer\r\n            })\r\n        });\r\n\r\n    let lastTime = Date.now()\r\n    let timeSinceLastFrame = 0\r\n\r\n    function animate() {\r\n        requestAnimationFrame(animate)\r\n        let now = Date.now()\r\n        timeSinceLastFrame = now - lastTime\r\n        updateCb(timeSinceLastFrame)\r\n        lastTime = now\r\n\r\n        renderer.render(stage)\r\n    }\r\n\r\n    requestAnimationFrame(animate)\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/setup.js\n ** module id = 2\n ** module chunks = 0\n **/","'use strict'\r\n\r\nfunction resize(canvas, ratio) {\r\n    let w = 0\r\n    let h = 0\r\n    let topOffset = 0\r\n    let leftOffset = 0\r\n    if (window.innerWidth / window.innerHeight >= ratio) {\r\n        w = window.innerHeight * ratio\r\n        h = window.innerHeight\r\n        leftOffset = (window.innerWidth - w)/2\r\n    } else {\r\n        w = window.innerWidth\r\n        h = window.innerWidth / ratio\r\n        topOffset = (window.innerHeight - h)/2\r\n    }\r\n    canvas.style.width = w + 'px'\r\n    canvas.style.height = h + 'px'\r\n    canvas.style.marginTop = topOffset + 'px'\r\n    canvas.style.marginLeft = leftOffset + 'px'\r\n    //canvas.width = w;\r\n    //canvas.height = h;\r\n}\r\n\r\nmodule.exports = function createOnResizeHandler(spec){\r\n    const canvas = spec.canvas\r\n    if(!canvas) {\r\n        throw 'canvas must not be undefined or null'\r\n    }\r\n    const ratio = spec.ratio\r\n\r\n    resize(canvas, ratio)\r\n\r\n    return function() {\r\n        resize(canvas, ratio)\r\n    }\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/core/createOnResizeHandler.js\n ** module id = 3\n ** module chunks = 0\n **/","'use strict'\r\n\r\nmodule.exports = function createGoFullscreenButton(spec){\r\n\r\n    const canvas = spec.canvas\r\n    if(!canvas) {\r\n        throw 'canvas must not be undefined or null'\r\n    }\r\n\r\n    function RequestFullscreen(elem) {\r\n        if (elem.requestFullscreen) {\r\n            elem.requestFullscreen()\r\n        }\r\n        else if (elem.msRequestFullscreen) {\r\n            elem.msRequestFullscreen()\r\n        }\r\n        else if (elem.mozRequestFullScreen) {\r\n            elem.mozRequestFullScreen()\r\n        }\r\n        else if (elem.webkitRequestFullscreen) {\r\n            elem.webkitRequestFullscreen()\r\n        }\r\n    }\r\n\r\n    var btn = document.createElement('BUTTON')\r\n    var t = document.createTextNode('Go To Fullscreen')\r\n    btn.appendChild(t)\r\n    btn.onclick = function(){\r\n        RequestFullscreen(canvas)\r\n    }\r\n    btn.style.position = 'absolute'\r\n    btn.style.left = '10px'\r\n    btn.style.top = '5px'\r\n    btn.style.height = '50px'\r\n    btn.style.opacity = '0.5'\r\n    \r\n    return btn\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/gui/createGoFullscreenButton.js\n ** module id = 4\n ** module chunks = 0\n **/","/**\r\n * Created by odrin on 21.09.2015.\r\n */\r\n'use strict'\r\n\r\nmodule.exports = function createKeyboardMappings(spec){\r\n    const emiter = spec.emiter\r\n\r\n    const keyboardMappings = [\r\n        {\r\n            keyboardCode : 49,\r\n            eventToEmit : 'r4two:action:editor'\r\n        },\r\n        {\r\n            keyboardCode : 192,\r\n            eventToEmit : 'r4two:action:console'\r\n        },\r\n        {\r\n            keyboardCode : 13,\r\n            eventToEmit : 'r4two:action:accept'\r\n        },\r\n        {\r\n            keyboardCode : 38,\r\n            eventToEmit : 'r4two:action:up'\r\n        },\r\n        {\r\n            keyboardCode : 40,\r\n            eventToEmit : 'r4two:action:down'\r\n        }\r\n    ]\r\n\r\n    window.onkeyup = function(e) {\r\n        const key = e.keyCode ? e.keyCode : e.which\r\n\r\n        keyboardMappings.forEach((el)=>{\r\n            if(el.keyboardCode === key){\r\n                emiter.emit(el.eventToEmit)\r\n            }\r\n        })\r\n    }\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/core/createKeyboardMappings.js\n ** module id = 5\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst Multiobserve = require('cb-multiobserve').Multiobserve\r\nconst validateMessage = require('../lib/message-validator').validateMessage\r\nconst createObjectStore = require('../lib/object-store').createObjectStore\r\nconst guid = require('../lib/guid').guid\r\n\r\nexports.createHyperionClient = require('./createHyperionClient')\r\nexports.hyperion = function(spec) {\r\n\r\n    if(spec.wss === undefined){\r\n        throw new Error('No socket found, please specify wss')\r\n    }\r\n    \r\n    function send(ws, object) {\r\n        ws.send(JSON.stringify(object))\r\n    }\r\n\r\n    const objectStore = createObjectStore((objRecord, changes) => {\r\n        const msg = JSON.stringify({\r\n            type: 'object-broadcast',\r\n            name: objRecord.name,\r\n            changes: changes\r\n        })\r\n        objRecord.bindings.forEach((ws) => {\r\n            ws.send(msg)\r\n        })\r\n    })\r\n    const newConnectionFn = spec.newConnectionFn\r\n    const errorFn = spec.errorFn\r\n    const wss = spec.wss\r\n    const model = spec.modelSpec.model\r\n    \r\n    objectStore.registerObject(model,0, 'index')\r\n\r\n    wss.on('connection', (ws) => {\r\n        if (typeof newConnectionFn === 'function') {\r\n            newConnectionFn(ws)\r\n        }\r\n\r\n        objectStore.bind(model, ws)\r\n\r\n        const name = guid()\r\n        const store = new Map()\r\n        const ctx = Object.freeze({\r\n            name,\r\n            emit: (adress, msg) => {\r\n                ws.send(ws, {\r\n                    type: 'message',\r\n                    adress: adress,\r\n                    message: msg\r\n                })\r\n            },\r\n            sync: (object) =>{\r\n                objectStore.bind(object, ws)\r\n            },\r\n            unsync: (object) => {\r\n                objectStore.unbind(object, ws)\r\n            },\r\n            onDisconnect: (callback)=>{\r\n                ws.on('close', function close() {\r\n                    callback()\r\n                })\r\n            },\r\n            disconnect: ()=>{\r\n                if(ws._socket !== null){\r\n                    ws._socket.server.close()\r\n                }\r\n            },\r\n            set :(key, value)=>{\r\n                return store.set(key, value)\r\n            },\r\n            get : (key) => {\r\n                return store.get(key)\r\n            },\r\n            has : (key) =>{\r\n                return store.has(key)\r\n            }\r\n        })\r\n\r\n        ws.on('message', (message) => {\r\n            try {\r\n                const validMessage = validateMessage(JSON.parse(message))\r\n                if (validMessage.type === 'object-call') {\r\n                    handleObjectCall(ws, ctx, validMessage)\r\n                }\r\n            }\r\n            catch (e) {\r\n                console.log(e)\r\n            }\r\n        })\r\n\r\n        ws.on('close', function close() {\r\n            spec.modelSpec.onLeave(ctx)\r\n            objectStore.allBindObjects(ws).forEach((ob) => {\r\n                objectStore.unbind(ob, ws)\r\n            })\r\n        })\r\n        spec.modelSpec.onJoin(ctx)\r\n        handleMethodResult(ws, 'index' , -1, model)\r\n    })\r\n\r\n\r\n    function handleObjectCall(ws,ctx, msg) {\r\n        const obj= objectStore.lookupByName(msg.name)\r\n        if (obj === undefined) {\r\n            return\r\n        }\r\n\r\n        const node = Multiobserve.findNode(obj, msg.path)\r\n\r\n        if (node !== undefined && typeof node === 'function') {\r\n            const result = node.apply(obj, [ctx].concat(msg.args))\r\n            if (result instanceof Promise) {\r\n                result.then(function(result) {\r\n                    handleMethodResult(ws, msg.name, msg.id, result)\r\n                })\r\n            }\r\n            else {\r\n                handleMethodResult(ws, msg.name, msg.id, result)\r\n            }\r\n        }\r\n    }\r\n\r\n    function handleMethodResult(ws, name, id, result) {\r\n        const objectRecord = objectStore.lookupByObject(result)\r\n        if (objectRecord !== undefined) {\r\n            send(ws, {\r\n                type: 'call-response',\r\n                name: name,\r\n                id: id,\r\n                synced: true,\r\n                methods: objectRecord.methods,\r\n                result: objectRecord.object,\r\n                resultName: objectRecord.name\r\n            })\r\n        } else {\r\n            send(ws, {\r\n                type: 'call-response',\r\n                name: name,\r\n                id: id,\r\n                synced: false,\r\n                result: result\r\n            })\r\n        }\r\n    }\r\n\r\n    return Object.freeze({\r\n        syncObject(object, lifetime){\r\n            return objectStore.registerObject(object, lifetime)\r\n        },\r\n        unsyncObject(object){\r\n            return objectStore.unregisterObject(object)\r\n        }\r\n    })\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/cb-hyperion/lib/hyperion.js\n ** module id = 6\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst objects = new WeakMap()\r\n\r\nfunction typeOf(value) {\r\n    let s = typeof value;\r\n    if (s === 'object') {\r\n        if (value) {\r\n            if (value instanceof Array) {\r\n                s = 'array'\r\n            }\r\n        }\r\n        else {\r\n            s = 'null';\r\n        }\r\n    }\r\n    return s;\r\n}\r\n\r\nfunction observeObject(ctx, object, path) {\r\n    let func = function (changes) {\r\n        changes.forEach(function(change) {\r\n            ctx.notify({\r\n                path: path.concat(change.name),\r\n                node: change.object,\r\n                type: change.type,\r\n                name: change.name,\r\n                oldValue: change.oldValue\r\n            })\r\n            if(change.type === 'add'){\r\n                if(!ctx.filter(object,path)) { return }\r\n                observeDeepObject(ctx, change.object, path)\r\n            } else if(change.type === 'delete') {\r\n                unobserveDeepObject(ctx, change.oldValue, path.concat(change.name))\r\n            }\r\n        })\r\n    }\r\n    ctx.setHandler(object, path, func)\r\n    Object.observe(object, func)\r\n}\r\n\r\nfunction observeArray(ctx, object, name, path) {\r\n    Array.observe(object, function(changes) {\r\n        changes.forEach(function(change) {\r\n            let msg = null\r\n            \r\n            if(change.type === 'update'){\r\n                msg = {\r\n                    path: path.concat(change.name),\r\n                    node: change.object,\r\n                    type: 'update',\r\n                    name: change.name,\r\n                    oldValue: change.oldValue\r\n                }\r\n            } else if (change.type === 'splice'){\r\n                msg = {\r\n                    path: path,\r\n                    node: change.object,\r\n                    type: 'update',\r\n                    arrayChangeType: change.type,\r\n                    name: name,\r\n                    index: change.index,\r\n                    removed: change.removed,\r\n                    //added: change.object.slice(change.index,change.addedCount),\r\n                    addedCount: change.addedCount,\r\n                    oldValue: change.oldValue\r\n                }\r\n                \r\n                let added = change.object.slice(change.index,change.index+change.addedCount);\r\n                \r\n                added.forEach(function(element){\r\n                    if(typeOf(element) !== 'array' && typeOf(element) !== 'object' && typeOf(element) !== 'function') { return }\r\n                    if(!ctx.filter(element,path.concat(String(change.index)))) { return }\r\n                    observeObject(ctx,element,path.concat(String(change.index)))\r\n                    observeDeepObject(ctx,element,path.concat(String(change.index)))\r\n                })\r\n                change.removed.forEach(function(element){\r\n                    if(typeOf(element) === 'array'){\r\n                        Array.unobserve(element, ctx.getHandler(element,path.concat(String(change.index))))\r\n                        unobserveDeepArray(ctx, element, change.path)\r\n                    } else if (typeOf(element) === 'object' || typeOf(element) === 'function') {\r\n                        Object.unobserve(element, ctx.getHandler(element,path.concat(String(change.index))))\r\n                        unobserveDeepObject(ctx, element, change.path)\r\n                    }\r\n                    \r\n                })\r\n            }\r\n            \r\n            ctx.notify(msg)\r\n        })\r\n    })\r\n}\r\n\r\nfunction unobserveDeepObject(ctx, object, path) {\r\n    Object.keys(object).forEach(function(property){\r\n        let propObject = object[property]\r\n\r\n        if (typeOf(propObject) === 'object') {\r\n            Object.unobserve(propObject, ctx.getHandler(propObject, path.concat(property)))\r\n            unobserveDeepObject( ctx, propObject, path.concat(property))\r\n        } else if(typeOf(propObject) === 'array'){\r\n            Array.unobserve(propObject, ctx.getHandler(propObject,path.concat(property)))\r\n            unobserveDeepArray(ctx, propObject, path.concat(property))\r\n        }\r\n    })\r\n}\r\n\r\nfunction unobserveDeepArray(ctx, array, path) {\r\n    array.forEach(function(element, index){\r\n\r\n        if (typeOf(element) === 'object' || typeOf(element) === 'function') {\r\n            Object.unobserve(element, ctx.getHandler(element, path.concat(String(index))))\r\n            unobserveDeepObject( ctx, element, path.concat(String(index)))\r\n        } else if(typeOf(element) === 'array'){\r\n            Array.unobserve(element, ctx.getHandler(element,path.concat(String(index))))\r\n            unobserveDeepArray(ctx, array, path.concat(String(index)))\r\n        }\r\n    })\r\n}\r\n\r\nfunction observeDeepObject(ctx, object, path) {\r\n    Object.keys(object).forEach(function(property){\r\n        const currPath = path.concat([property])\r\n        const propObject = object[property]\r\n\r\n        if (typeOf(propObject) === 'object' || typeOf(propObject) === 'function') {\r\n            if(!ctx.filter(propObject,currPath)) { return }\r\n            observeObject(ctx, propObject, currPath)\r\n            observeDeepObject(ctx, propObject, currPath)\r\n        } else if(typeOf(propObject) === 'array'){\r\n            if(!ctx.filter(propObject,currPath)) { return }\r\n            observeArray(ctx,propObject,property,currPath)\r\n            observeDeepArray(ctx, propObject, currPath)\r\n        }\r\n    })\r\n}\r\n\r\nfunction observeDeepArray(ctx, array, path) {\r\n    array.forEach(function(element, index) {\r\n        const currPath = path.concat(String(index))\r\n\r\n        if(typeOf(element) === 'array') {\r\n            if(!ctx.filter(element,currPath)) { return }\r\n            observeArray(ctx,element,currPath)\r\n            observeDeepArray(ctx, element, currPath)\r\n        } else if(typeOf(element) === 'object' || typeOf(element) === 'function') {\r\n            if(!ctx.filter(element,currPath)) { return }\r\n            observeObject(ctx,element,currPath)\r\n            observeDeepObject(ctx, element, currPath)\r\n        }\r\n    })\r\n}\r\n\r\nfunction comparePaths(path1, path2){\r\n    return (path1.length === path2.length) && path1.every(function(element, index) {\r\n        return element === path2[index];\r\n    })\r\n}\r\n\r\nfunction findAndAddMethod(object, path, methods){\r\n    Object.getOwnPropertyNames(object).forEach(function(prop){\r\n        if(typeOf(object[prop]) === 'function'){\r\n            methods.push(path.concat(prop))\r\n        }\r\n        if(typeOf(object[prop]) === 'object'){\r\n            findAndAddMethod(object[prop],path.concat(prop), methods)\r\n        }\r\n        if(typeOf(object[prop]) === 'array'){\r\n            object[prop].forEach(function(el, index){\r\n                findAndAddMethod(el,path.concat(prop).concat(String(index)), methods)\r\n            })\r\n        }\r\n    })\r\n}\r\n\r\nexports.Multiobserve = {\r\n    observe(object, callback, filterCallback){\r\n        const root = {}\r\n        const rootNotifier = Object.getNotifier(root)\r\n        const handlers = new WeakMap()\r\n        const ctx = Object.freeze({\r\n            notify(msg) {\r\n                rootNotifier.notify(msg)\r\n            },\r\n            setHandler(object, path, handler ) {\r\n                let ph = handlers.get(object)\r\n                let o = {\r\n                    handler,\r\n                    path\r\n                }\r\n                if(ph === undefined){\r\n                    ph = [o]\r\n                    handlers.set(object, ph)\r\n                } else {\r\n                    if(!ph.some(function(el){\r\n                        return comparePaths(el.path, path)\r\n                    })){\r\n                        ph.push(o)\r\n                    }\r\n                }\r\n\r\n            },\r\n            getHandler(object, path){\r\n                let ph = handlers.get(object)\r\n                let result = void(0)\r\n                ph.forEach(function(el){\r\n                    if(comparePaths(el.path, path)){\r\n                        result = el.handler\r\n                    }\r\n                })\r\n                return result\r\n            },\r\n            filter(node, path){\r\n                return filterCallback === undefined ? true : filterCallback(node, path)\r\n            }\r\n        })\r\n        observeObject(ctx, object, [])\r\n        observeDeepObject(ctx, object, [])\r\n        Object.observe(root,function(changes){\r\n            callback(changes.map(function(change){\r\n                if(change.arrayChangeType === 'splice'){\r\n                    return {\r\n                        node : change.node || object,\r\n                        path : change.path || change.name,\r\n                        type : 'splice',\r\n                        index: change.index,\r\n                        removed: change.removed,\r\n                        addedCount: change.addedCount\r\n                    }\r\n                } else if(change.type === 'update' || change.type === 'add' || change.type === 'delete'){\r\n                    return {\r\n                        node : change.node || object,\r\n                        path : change.path || change.name,\r\n                        type : change.type,\r\n                        oldValue : change.oldValue\r\n                    }\r\n                }\r\n                return {}\r\n            }))\r\n        })\r\n        objects.set(object, {\r\n            root,\r\n            rootNotifier,\r\n            handlers,\r\n            ctx\r\n        })\r\n        return {\r\n            performChange(name, changeFn){\r\n                rootNotifier.notify({\r\n                    name : name,\r\n                    type : 'update',\r\n                    batchChangeType : 'begin'\r\n                })\r\n                const resultMsg = changeFn()\r\n                rootNotifier.notify({\r\n                    name : name,\r\n                    type : 'update',\r\n                    batchChangeType : 'end',\r\n                    resultMsg : resultMsg\r\n                })\r\n            }\r\n        }\r\n    },\r\n    findNode(object, path){\r\n        if(!Array.isArray(path)) {\r\n            return undefined\r\n        }\r\n        let curr = object\r\n        path.every(function(node) {\r\n            if (curr[node] !== undefined) {\r\n                curr = curr[node]\r\n                return true\r\n            } else {\r\n                curr = undefined\r\n                return false\r\n            }\r\n        })\r\n        return curr\r\n    },\r\n    methodsToPaths(object){\r\n        const methods = []\r\n        \r\n        findAndAddMethod(object, [], methods)\r\n        return methods\r\n    }\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/cb-hyperion/~/cb-multiobserve/lib/multiobserve.js\n ** module id = 7\n ** module chunks = 0\n **/","exports.validateMessage = (msg) =>{\r\n\r\n    if (!msg.hasOwnProperty('type')) {\r\n        throw new Error('Missing type property.')\r\n    }\r\n    if (msg.type !== 'object-get' && msg.type !== 'object-call') {\r\n        throw new Error('Type must be one of [object-get,object-call].')\r\n    }\r\n    \r\n    if(msg.type === 'object-get'){\r\n    \r\n        if (!msg.hasOwnProperty('name')) {\r\n            throw new Error('Missing name property.')\r\n        }\r\n        \r\n    } else if(msg.type === 'object-call'){\r\n        if (!msg.hasOwnProperty('name')) {\r\n            throw new Error('Missing name property.')\r\n        }\r\n        if (!msg.hasOwnProperty('path')) {\r\n            throw new Error('Missing path property.')\r\n        }\r\n        if (!Array.isArray(msg.path)) {\r\n            throw new Error('Property path is not an array.')\r\n        }\r\n        if (!msg.hasOwnProperty('args')) {\r\n            throw new Error('Missing args property.')\r\n        }\r\n        if (!Array.isArray(msg.args)) {\r\n            throw new Error('Property args is not an array.')\r\n        }\r\n        if (!msg.hasOwnProperty('id')) {\r\n            throw new Error('Missing id property.')\r\n        }\r\n    }\r\n    \r\n    return msg\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/cb-hyperion/lib/message-validator.js\n ** module id = 8\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst Multiobserve = require('cb-multiobserve').Multiobserve\r\nconst guid = require('../lib/guid').guid\r\n\r\nexports.createObjectStore = function (transformer) {\r\n    \r\n    const objectToRecord = new Map()\r\n    const nameToRecord = new Map()\r\n    const targetToObjects = new Map()\r\n    \r\n    const trfm = transformer || (()=>{})\r\n    \r\n    let statObject\r\n    \r\n    const self = Object.freeze({\r\n        registerObject(obj, lifetime, name){\r\n            let objRecord = objectToRecord.get(obj)\r\n            if(objRecord === undefined){\r\n                objRecord = Object.freeze({\r\n                    name : (name || guid()),\r\n                    bindings : new Set(),\r\n                    object : obj,\r\n                    methods : [],\r\n                    lifetime : (lifetime || 0),\r\n                    timerHandle : -1\r\n                })\r\n                objectToRecord.set(obj, objRecord)\r\n                nameToRecord.set(objRecord.name, objRecord)\r\n                \r\n                Multiobserve.observe(obj,(changes) => {\r\n                    trfm(objRecord, changes)\r\n                },\r\n                (node, path) => {\r\n                    if(typeof node === 'function'){\r\n                        objRecord.methods.push(path)\r\n                    }\r\n                    return true\r\n                })\r\n                if(statObject !== undefined){\r\n                    statObject.objects++\r\n                }\r\n            } \r\n            return objRecord\r\n        },\r\n        unregisterObject(obj){\r\n            const objRecord = objectToRecord.get(obj)\r\n            if(objRecord !== undefined){\r\n                Multiobserve.unobserve(objRecord.object)\r\n                objectToRecord.delete(objRecord)\r\n                nameToRecord.delete(objRecord)\r\n                if(statObject !== undefined){\r\n                    statObject.objects--\r\n                }\r\n            }\r\n        },\r\n        bind(object, target){\r\n            let objRecord = objectToRecord.get(object)\r\n            if(objRecord === undefined){\r\n                objRecord = self.registerObject(object)\r\n            }\r\n            \r\n            objRecord.bindings.add(target)\r\n            const objects = targetToObjects.get(target)\r\n            if(objects === undefined){\r\n                targetToObjects.set(target, new Set([objRecord.object]))\r\n                if(statObject !== undefined){\r\n                    statObject.targets++\r\n                }\r\n            } else {\r\n                objects.add(objRecord.object)\r\n            }\r\n            if(objRecord.timerHandle !== -1){\r\n                clearTimeout(objRecord.timerHandle)\r\n                objRecord.timerHandle = -1\r\n            }\r\n            \r\n            return objRecord\r\n        },\r\n        unbind(object, target){\r\n            const objRecord = objectToRecord.get(object)\r\n            if(objRecord !== undefined){\r\n                objRecord.bindings.delete(target)\r\n                const objects = targetToObjects.get(target)\r\n                if(objects !== undefined){\r\n                    objects.delete(objRecord.object)\r\n                    if(objects.size === 0 && statObject !== undefined){\r\n                        statObject.targets--\r\n                    }\r\n                }\r\n                if(objRecord.bindings.size === 0 && objRecord.lifetime !== 0){\r\n                    if(objRecord.timerHandle !== -1) {\r\n                        clearTimeout(objRecord.timerHandle)\r\n                    }\r\n                    objRecord.timerHandle = setTimeout(()=>{\r\n                        self.unregisterObject(objRecord.object)\r\n                        objRecord.timerHandle = -1\r\n                    }, objRecord.lifetime)\r\n                }\r\n            }\r\n            return objRecord\r\n        },\r\n        lookupByName(name){\r\n            const objRecord = nameToRecord.get(name)\r\n            if(objRecord !== undefined){\r\n                return objRecord.object\r\n            }\r\n            return undefined\r\n        },\r\n        lookupByObject(object){\r\n            const objRecord = objectToRecord.get(object)\r\n            if(objRecord !== undefined){\r\n                return objRecord\r\n            }\r\n            return undefined\r\n        },\r\n        allBindObjects(target){\r\n            return targetToObjects.get(target)\r\n        },\r\n        getStatObject(){\r\n            if(statObject === undefined){\r\n                statObject = Object.freeze({\r\n                    objects : Number(objectToRecord.size),\r\n                    targets : Number(targetToObjects.size)\r\n                })\r\n                self.registerObject(statObject)\r\n            }\r\n            return statObject\r\n        }\r\n    })\r\n    \r\n    return self\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/cb-hyperion/lib/object-store.js\n ** module id = 9\n ** module chunks = 0\n **/","exports.guid = function guid() {\r\n    function s4() {\r\n        return Math.floor((1 + Math.random()) * 0x10000)\r\n            .toString(16)\r\n            .substring(1);\r\n    }\r\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\r\n        s4() + '-' + s4() + s4() + s4();\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/cb-hyperion/lib/guid.js\n ** module id = 10\n ** module chunks = 0\n **/","'use strict'\r\n\r\nconst createChangeHandler = require('./createChangeHandler')\r\n\r\nmodule.exports = function createHyperionClient(spec) {\r\n    const socket = spec.socket || new WebSocket(spec.host)\r\n    const response = Object.create(null,{})\r\n    const objects = Object.create(null,{})\r\n    const changeHandler = createChangeHandler()\r\n    let id = 0\r\n    let messageLock = false\r\n    let messages = []\r\n\r\n    function send(msg){\r\n        console.log('=>')\r\n        console.log(msg)\r\n        socket.send(JSON.stringify(msg))\r\n    }\r\n\r\n    function createProxyMethod(object, objectName, method) {\r\n        let curr = object\r\n        method.forEach(function(node) {\r\n            if (curr[node] === undefined) {\r\n                curr[node] = function() {\r\n                    const currId = id++\r\n\r\n                    const promise = new Promise(function(resolve, reject) {\r\n                        response[currId] = {\r\n                            resolve: resolve,\r\n                            reject: reject\r\n                        }\r\n                    })\r\n                    const msg = {\r\n                        type : 'object-call',\r\n                        path : method,\r\n                        name : objectName,\r\n                        id : currId,\r\n                        args : Array.prototype.slice.call(arguments, 0)\r\n                    }\r\n                    send(msg)\r\n                    return promise\r\n                }\r\n            }\r\n            else {\r\n                curr = curr[node]\r\n            }\r\n        })\r\n\r\n    }\r\n\r\n    function applyChange(object, change, next){\r\n        if(change.type === 'update'){\r\n            let curr = object\r\n            change.path.forEach(function(node){\r\n                if(change.path[change.path.length-1] === node){\r\n                    curr[node] = change.node[change.path[change.path.length -1]]\r\n                }\r\n                curr = curr[node]\r\n            })\r\n            changeHandler.fireOnChangeEvent({\r\n                path: change.path,\r\n                newValue : change.node[change.path[change.path.length -1]],\r\n                oldValue : change.oldValue,\r\n                next : next\r\n            })\r\n        } else if(change.type === 'splice'){\r\n            let curr = object\r\n            change.path.forEach(function(node){\r\n                if(change.path[change.path.length-1] === node){\r\n                    curr[node].splice.apply(curr[node],[change.index,change.removedCount].concat(change.added))\r\n                }\r\n                curr = curr[node]\r\n            })\r\n            next()\r\n        }\r\n    }\r\n\r\n    function applyChanges(object, changes, next){\r\n        let nextCb\r\n        let entries = changes.entries()\r\n        nextCb = ()=>{\r\n            let entry = entries.next()\r\n            if(entry.done) {\r\n                return next()\r\n            } else {\r\n                return applyChange(object, entry.value[1], nextCb)\r\n            }\r\n        }\r\n        nextCb()\r\n    }\r\n\r\n    const clientCtx = {\r\n        model: {},\r\n        createChangeListener : changeHandler.registerHandler\r\n    }\r\n\r\n    return new Promise(function(resolve, reject) {\r\n\r\n        function process(){\r\n            if(messageLock === true) {\r\n                return\r\n            }\r\n            if(messages.length >= 1){\r\n                messageLock = true\r\n                apply(messages.shift())\r\n            }\r\n        }\r\n\r\n        function apply(data) {\r\n            let msg = JSON.parse(data)\r\n            console.log('<=')\r\n            console.log(msg)\r\n            if (msg.type === 'call-response') {\r\n                if(msg.synced === true && objects[msg.resultName] === undefined){\r\n                    msg.methods.forEach(function(method) {\r\n                        createProxyMethod(msg.result, msg.resultName, method)\r\n                    })\r\n                    if(msg.resultName === 'index'){\r\n                        clientCtx.model = msg.result\r\n                        resolve(clientCtx)\r\n                    }\r\n                    objects[msg.resultName] = msg.result\r\n                }\r\n\r\n                if(response[msg.id] !== undefined){\r\n                    response[msg.id].resolve(msg.result)\r\n                    delete response[msg.id]\r\n                }\r\n                messageLock = false\r\n                setTimeout(process,0)\r\n            } else if (msg.type === 'object-broadcast') {\r\n                console.log('applying changes')\r\n                const object = objects[msg.name]\r\n                if(object){\r\n                    applyChanges(object, msg.changes, ()=>{\r\n                        messageLock = false\r\n                        setTimeout(process,0)\r\n                    })\r\n                } else {\r\n                    console.log('object not found '+msg.name)\r\n                    messageLock = false\r\n                    setTimeout(process,0)\r\n                }\r\n            } else {\r\n                messageLock = false\r\n                setTimeout(process,0)\r\n            }\r\n        }\r\n\r\n        socket.onopen = function() {\r\n            if (spec.onopen) {\r\n                spec.onopen(clientCtx)\r\n            }\r\n        }\r\n\r\n        socket.onmessage = function(event) {\r\n            messages.push(event.data)\r\n            if(messages.length === 1){\r\n                setTimeout(process,0)\r\n            }\r\n        }\r\n\r\n        socket.onerror = function(event){\r\n            if(clientCtx.model === undefined){\r\n                reject(event)\r\n            }\r\n        }\r\n    })\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/cb-hyperion/lib/createHyperionClient.js\n ** module id = 11\n ** module chunks = 0\n **/","/**\r\n * Created by odrin on 18.09.2015.\r\n */\r\n'use strict'\r\n\r\nmodule.exports = function createChangeHandler(){\r\n\r\n    const listeners = {}\r\n    const onChangeId = Symbol()\r\n\r\n    function findParentForPath(path, index, parent) {\r\n        if(index === path.length - 1){\r\n            return parent\r\n        } else {\r\n            if(parent[path[index]] === undefined){\r\n                parent[path[index]] = {}\r\n            }\r\n            return findParentForPath(path, index + 1, parent[path[index]])\r\n        }\r\n    }\r\n\r\n    return {\r\n        registerHandler(spec){\r\n            const path = spec.path\r\n            const onChange = spec.onChange\r\n\r\n            if(path.length === 0 || onChange === undefined){\r\n                return\r\n            }\r\n\r\n            const parent = findParentForPath(path, 0, listeners)\r\n            if(parent[path[path.length-1]] === undefined){\r\n                parent[path[path.length-1]] = {}\r\n            }\r\n            if(parent[path[path.length-1]][onChangeId] === undefined){\r\n                parent[path[path.length-1]][onChangeId] = []\r\n            }\r\n            parent[path[path.length-1]][onChangeId].push(onChange)\r\n        },\r\n        fireOnChangeEvent(spec){\r\n            const path = spec.path\r\n            const oldValue = spec.oldValue\r\n            const newValue = spec.newValue\r\n            const next = spec.next\r\n\r\n            if(path.length === 0 || oldValue === undefined || newValue === undefined){\r\n                next()\r\n                return\r\n            }\r\n\r\n            const parent = findParentForPath(path, 0 , listeners)\r\n            if(parent[path[path.length-1]] === undefined){\r\n                next()\r\n                return\r\n            }\r\n            if(parent[path[path.length-1]][onChangeId] === undefined){\r\n                next()\r\n                return\r\n            }\r\n            const entrIter = parent[path[path.length-1]][onChangeId].entries()\r\n\r\n            let nextCb\r\n\r\n            nextCb = ()=>{\r\n                let entry = entrIter.next()\r\n                if(entry.done) {\r\n                    return next()\r\n                } else {\r\n                    return entry.value[1](path, oldValue, newValue, nextCb)\r\n                }\r\n            }\r\n            nextCb()\r\n        }\r\n\r\n    }\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/cb-hyperion/lib/createChangeHandler.js\n ** module id = 12\n ** module chunks = 0\n **/","'use strict'\r\n/*global PIXI */\r\n\r\nmodule.exports = function createBoard(spec){\r\n    const clientCtx = spec.clientCtx\r\n    const graphicsCtx = spec.graphicsCtx\r\n    const emiter = spec.emiter\r\n    const parent = spec.parent\r\n\r\n    const model = clientCtx.model\r\n\r\n    const resources = graphicsCtx.resources\r\n\r\n    const debug = false\r\n    const board = new PIXI.Container()\r\n\r\n    board.position.x = 48\r\n    board.position.y = 48\r\n    board.hitArea = new PIXI.Rectangle(0, 0, model.board.width*resources.floor.frameWidth, model.board.height*resources.floor.frameWidth);\r\n    board.interactive = true\r\n    board.buttonMode = true\r\n\r\n    let disableInput = false\r\n    board.on('mousedown', (mouseData)=>{\r\n        const pos = mouseData.data.getLocalPosition(board)\r\n        const x = Math.floor(pos.x  / resources.floor.frameWidth)\r\n        const y = Math.floor(pos.y / resources.floor.frameWidth)\r\n        const tile = model.board.data[y*model.board.width+x]\r\n        if(tile.visibility === 'visible'){\r\n            emiter.emit('r4two:board:tileselect',{\r\n                position : {\r\n                    x : x,\r\n                    y : y,\r\n                },\r\n                obstacle : tile.obstacle\r\n            })\r\n            if(disableInput === true){\r\n                return\r\n            }\r\n            model.setTargetTo(x, y)\r\n        }\r\n    })\r\n\r\n    emiter.on('r4two:editor:visible', (flag)=>{\r\n        disableInput = flag\r\n    })\r\n\r\n    const createTileLayer = (data, name, tile, i) => {\r\n        if(data === ''){\r\n            data = 'wall_5'\r\n        }\r\n        const sp = data.split('_')\r\n        const ceiling = new PIXI.Sprite(resources[sp[0]].frames[sp[1]])\r\n\r\n        clientCtx.createChangeListener({\r\n            path:['board','data',i.toString(),'layers',name],\r\n            onChange : (path, oldValue, newValue, next)=>{\r\n                if(newValue === ''){\r\n                    newValue = 'wall_5'\r\n                }\r\n                const sp = newValue.split('_')\r\n                ceiling.texture = resources[sp[0]].frames[sp[1]]\r\n                next()\r\n            }\r\n        })\r\n\r\n        tile.addChild(ceiling)\r\n    }\r\n\r\n    const createTileFogOfWar = (tile, i)=>{\r\n        const fogofwar = new PIXI.Sprite(resources.fogofwar.frames[0])\r\n        fogofwar.alpha = 0.5\r\n        if(tile.visibility === 'discovered'){\r\n            fogofwar.visible = true\r\n        } else {\r\n            fogofwar.visible = false\r\n        }\r\n        clientCtx.createChangeListener({\r\n            path:['board','data',i.toString(),'visibility'],\r\n            onChange : (path, oldValue, newValue, next)=>{\r\n                if(newValue === 'discovered'){\r\n                    fogofwar.visible = true\r\n                } else {\r\n                    fogofwar.visible = false\r\n                }\r\n                next()\r\n            }\r\n        })\r\n        tile.addChild(fogofwar)\r\n    }\r\n\r\n    model.board.data.forEach((el, i)=> {\r\n\r\n        const tile = new PIXI.Container()\r\n        tile.position.x = (i % model.board.width) * resources.floor.frameWidth\r\n        tile.position.y = Math.floor(i / model.board.width) * resources.floor.frameHeight\r\n\r\n        createTileLayer(el.layers.floor, 'floor', tile, i)\r\n        createTileLayer(el.layers.middle, 'middle', tile, i)\r\n        createTileLayer(el.layers.ceiling, 'ceiling', tile, i)\r\n\r\n        createTileFogOfWar(tile, i)\r\n\r\n        if(debug === true){\r\n            const texObst = resources.debug.frames[0]\r\n            const texNonObst = resources.wall.frames[5]\r\n\r\n            const debug = new PIXI.Sprite(texNonObst)\r\n            clientCtx.createChangeListener({\r\n                path:['board','data',i.toString(),'obstacle'],\r\n                onChange : (path, oldValue, newValue, next)=>{\r\n                    debug.texture = newValue ? texObst : texNonObst\r\n                    next()\r\n                }\r\n            })\r\n            emiter.on('r4two:editor:show-obstacles', (flag)=>{\r\n                if(flag === true){\r\n                    debug.texture = el.obstacle ? texObst : texNonObst\r\n                } else {\r\n                    debug.texture = texNonObst\r\n                }\r\n            })\r\n            tile.addChild(debug)\r\n        }\r\n\r\n        board.addChild(tile)\r\n    })\r\n\r\n    parent.addChild(board)\r\n\r\n    return {\r\n        container : ()=>{\r\n            return board\r\n        }\r\n    }\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/core/createBoard.js\n ** module id = 13\n ** module chunks = 0\n **/","/**\r\n * Created by odrin on 23.09.2015.\r\n */\r\n'use strict'\r\n/*global PIXI */\r\n\r\nmodule.exports = function createPlayer(spec){\r\n    const clientCtx = spec.clientCtx\r\n    const graphicsCtx = spec.graphicsCtx\r\n    const emiter = spec.emiter\r\n    const name = spec.name\r\n    const parent = spec.parent\r\n\r\n    const stage = graphicsCtx.stage\r\n    const model = clientCtx.model\r\n    const resources = graphicsCtx.resources\r\n    const player = model.players[name]\r\n    const frames = resources[player.className].frames\r\n    const frameWidth = resources[player.className].frameWidth\r\n\r\n    const playerContainer = new PIXI.Container()\r\n    playerContainer.position.x = Number(player.position.x) * frameWidth\r\n    playerContainer.position.y = Number(player.position.y) * frameWidth\r\n\r\n\r\n    const directions = {\r\n        up : Symbol(),\r\n        down : Symbol(),\r\n        left : Symbol(),\r\n        right : Symbol(),\r\n        iddle : Symbol()\r\n    }\r\n\r\n    clientCtx.createChangeListener({\r\n        path:['players',name, 'position'],\r\n        onChange : (path, oldValue, newValue, next)=>{\r\n            playerContainer.position.x = Number(newValue.x) * frameWidth\r\n            playerContainer.position.y = Number(newValue.y) * frameWidth\r\n            next()\r\n        }\r\n    })\r\n\r\n\r\n    let createAnimation = (frames, visible)=>{\r\n        let animation = new PIXI.extras.MovieClip(frames)\r\n        animation.visible = visible\r\n        animation.animationSpeed = 0.1\r\n        animation.gotoAndPlay(0)\r\n        playerContainer.addChild(animation)\r\n    }\r\n\r\n    let animations = {}\r\n    animations[directions.down] = createAnimation([frames[0], frames[1], frames[2], frames[3]], true)\r\n    animations[directions.left] = createAnimation([frames[4], frames[5], frames[6], frames[7]], false)\r\n    animations[directions.right] = createAnimation([frames[8], frames[9], frames[10], frames[11]], false)\r\n    animations[directions.up] = createAnimation([frames[12], frames[13], frames[14], frames[15]], false)\r\n\r\n    parent.addChild(playerContainer)\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/core/createPlayer.js\n ** module id = 14\n ** module chunks = 0\n **/","/**\r\n * Created by odrin on 23.09.2015.\r\n */\r\n'use strict'\r\n/*global PIXI */\r\n\r\nmodule.exports = function createTargetPointer(spec){\r\n    const clientCtx = spec.clientCtx\r\n    const graphicsCtx = spec.graphicsCtx\r\n    const emiter = spec.emiter\r\n    const name = spec.name\r\n    const parent = spec.parent\r\n\r\n    const resources = graphicsCtx.resources\r\n    const model = clientCtx.model\r\n    const player = model.players[name]\r\n    const frameWidth = resources[player.className].frameWidth\r\n\r\n    const pathContainer = new PIXI.Container()\r\n    parent.addChild(pathContainer)\r\n    const pathWithSteps = []\r\n\r\n    const selectTexture = (previous, current, next)=>{\r\n        if(previous === undefined){\r\n            if(current.y === next.y){\r\n                if(current.x < next.x){\r\n                    return resources.walking.frames[11]\r\n                } else {\r\n                    return resources.walking.frames[8]\r\n                }\r\n            }\r\n            if(current.x === next.x){\r\n                if(current.y < next.y){\r\n                    return resources.walking.frames[10]\r\n                } else {\r\n                    return resources.walking.frames[5]\r\n                }\r\n            }\r\n        }\r\n        if(next === undefined){\r\n            if(current.y === previous.y){\r\n                if(current.x < previous.x){\r\n                    return resources.walking.frames[11]\r\n                } else {\r\n                    return resources.walking.frames[8]\r\n                }\r\n            }\r\n            if(current.x === previous.x){\r\n                if(current.y < previous.y){\r\n                    return resources.walking.frames[10]\r\n                } else {\r\n                    return resources.walking.frames[5]\r\n                }\r\n            }\r\n        }\r\n        if(previous.x === next.x){\r\n            return resources.walking.frames[12]\r\n        }\r\n        if(previous.y === next.y){\r\n            return resources.walking.frames[2]\r\n        }\r\n        if(previous.y - next.y === -1 && previous.x - next.x === -1){\r\n            if(previous.y === current.y){\r\n                return resources.walking.frames[6]\r\n            } else {\r\n                return resources.walking.frames[3]\r\n            }\r\n\r\n        }\r\n        if(previous.y - next.y === 1 && previous.x - next.x === 1){\r\n            if(previous.y === current.y){\r\n                return resources.walking.frames[3]\r\n            } else {\r\n                return resources.walking.frames[6]\r\n            }\r\n        }\r\n        if(previous.y - next.y === 1 && previous.x - next.x === -1){\r\n            if(previous.y === current.y){\r\n                return resources.walking.frames[7]\r\n            } else {\r\n                return resources.walking.frames[9]\r\n            }\r\n        }\r\n        if(previous.y - next.y === -1 && previous.x - next.x === 1){\r\n            if(previous.y === current.y){\r\n                return resources.walking.frames[9]\r\n            } else {\r\n                return resources.walking.frames[7]\r\n            }\r\n        }\r\n        return resources.walking.frames[2]\r\n    }\r\n\r\n    const updatePath = (path)=>{\r\n        while(pathWithSteps.length < path.length){\r\n            let pathStep = new PIXI.Sprite(resources.walking.frames[2])\r\n            pathWithSteps.push(pathStep)\r\n            pathContainer.addChild(pathStep)\r\n        }\r\n        path.forEach((step, i)=>{\r\n            let pathStep = pathWithSteps[i]\r\n            pathStep.position.x = step.x * frameWidth\r\n            pathStep.position.y = step.y * frameWidth\r\n            pathStep.texture = selectTexture(path[i-1], path[i], path[i+1])\r\n            pathStep.visible = true\r\n        })\r\n        for( let i = path.length; i < pathWithSteps.length ; ++i){\r\n            pathWithSteps[i].visible = false\r\n        }\r\n    }\r\n    clientCtx.createChangeListener({\r\n        path:['players',name,'target', 'path'],\r\n        onChange : (path, oldValue, newValue, next)=>{\r\n            updatePath(newValue)\r\n            next()\r\n        }\r\n    })\r\n\r\n    let disableInput = false\r\n\r\n    let targetId = name === 'aPlayer' ? 0 : 1\r\n    const targetPointer = new PIXI.Sprite(resources.walking.frames[targetId])\r\n    targetPointer.position.x = player.target.position.x * frameWidth\r\n    targetPointer.position.y = player.target.position.y * frameWidth\r\n    parent.addChild(targetPointer)\r\n\r\n    clientCtx.createChangeListener({\r\n        path:['players',name,'target', 'position'],\r\n        onChange : (path, oldValue, newValue, next)=>{\r\n            targetPointer.position.x = Number(newValue.x) * frameWidth\r\n            targetPointer.position.y = Number(newValue.y) * frameWidth\r\n            next()\r\n        }\r\n    })\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/core/createTargetPointer.js\n ** module id = 15\n ** module chunks = 0\n **/","/**\r\n * Created by odrin on 14.09.2015.\r\n */\r\n'use strict'\r\n/*global PIXI */\r\n/*global EZGUI */\r\n\r\nmodule.exports = function createConsole(spec){\r\n    const graphicsCtx = spec.graphicsCtx\r\n    const emiter = spec.emiter\r\n    const renderer = graphicsCtx.renderer\r\n    const stage = graphicsCtx.stage\r\n    const numberOfLines = spec.numberOfLines || 11\r\n    const maxLineLength = spec.maxLineLength || 60\r\n\r\n    let inputListener = ()=>{}\r\n    const guiConsole = new PIXI.Container()\r\n    guiConsole.visible = false\r\n    const lines = []\r\n    const history = []\r\n    let historyPointer = 0\r\n\r\n    for(let i=numberOfLines;i>0;--i){\r\n        const line = new PIXI.Text('',{font : '20px Arial', fill : 0xffffff, align : 'center'});\r\n        line.position.x = 15\r\n        line.position.y = 10 + i*25\r\n        lines.push(line);\r\n        guiConsole.addChild(line)\r\n    }\r\n\r\n    const guiBtn = {\r\n        id: 'sendButton',\r\n        text: 'Send',\r\n        component: 'Button',\r\n        skin: 'bluebutton',\r\n        padding: 4,\r\n        position: { x: 535, y: 315 },\r\n        width: 90,\r\n        height: 30\r\n    }\r\n\r\n    const guiInput = {\r\n        id: 'commandInput',\r\n        text: '',\r\n        component: 'Input',\r\n        position: { x: 10, y: 315 },\r\n        width: 520,\r\n        height: 30\r\n    }\r\n\r\n    const commit = () => {\r\n        history.push(EZGUI.components.commandInput.text)\r\n        historyPointer = history.length\r\n        inputListener(EZGUI.components.commandInput.text)\r\n        EZGUI.components.commandInput.text = ''\r\n    }\r\n\r\n    EZGUI.renderer = renderer;\r\n    EZGUI.Theme.load(['/assets/ezgui/kenney-theme/kenney-theme.json'], function () {\r\n        const sendBtn = EZGUI.create(guiBtn, 'kenney')\r\n        const inputBtn = EZGUI.create(guiInput, 'kenney')\r\n        EZGUI.components.sendButton.on('click', function (event) {\r\n            commit()\r\n        })\r\n        guiConsole.addChild(sendBtn)\r\n        guiConsole.addChild(inputBtn)\r\n    })\r\n\r\n    stage.addChild(guiConsole)\r\n\r\n\r\n    emiter.on('r4two:action:console',()=>{\r\n        guiConsole.visible = !guiConsole.visible\r\n        EZGUI.components.commandInput.text = ''\r\n    })\r\n\r\n    emiter.on('r4two:action:accept',()=>{\r\n        commit()\r\n    })\r\n\r\n    emiter.on('r4two:action:up',()=>{\r\n        historyPointer--\r\n        if(history.length !== 0 && historyPointer < history.length && historyPointer >= 0){\r\n            EZGUI.components.commandInput.text = history[historyPointer]\r\n        } else {\r\n            historyPointer++\r\n        }\r\n    })\r\n\r\n    emiter.on('r4two:action:down',()=>{\r\n        historyPointer++\r\n        if(history.length !== 0 && historyPointer >= 0){\r\n            if(historyPointer < history.length){\r\n                EZGUI.components.commandInput.text = history[historyPointer]\r\n            } else {\r\n                EZGUI.components.commandInput.text = ''\r\n                historyPointer = history.length\r\n            }\r\n        } else {\r\n            historyPointer--\r\n        }\r\n    })\r\n\r\n    const write = (text)=>{\r\n        for(let i=lines.length-1; i>0;--i){\r\n            lines[i].text = lines[i-1].text\r\n        }\r\n        lines[0].text = text\r\n    }\r\n\r\n    return {\r\n        writeLine(text){\r\n            const words = text.split(' ')\r\n            while(words.length !== 0){\r\n                let line = words.splice(0,1);\r\n                while(words.length !== 0 && line.length+words[0].length+1 < maxLineLength){\r\n                    line = line+' '+words.splice(0,1)\r\n                }\r\n                if(line > maxLineLength){\r\n                    const parts = line.slice(maxLineLength)\r\n                    line = parts[0]\r\n                    words.splice(0,0,line[1])\r\n                }\r\n                write(line)\r\n            }\r\n        },\r\n        setInputListener(il){\r\n            inputListener = il\r\n        },\r\n        show(){\r\n\r\n        },\r\n        hide(){\r\n\r\n        }\r\n    }\r\n}\r\n\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/console/createConsole.js\n ** module id = 16\n ** module chunks = 0\n **/","/**\r\n * Created by odrin on 21.09.2015.\r\n */\r\n'use strict'\r\n/*global PIXI */\r\n\r\nconst createEditorIcon = require('./createEditorIcon')\r\nconst createTileSetPalette = require('./createTileSetPalette')\r\n\r\nmodule.exports = function createEditor(spec){\r\n    const graphicsCtx = spec.graphicsCtx\r\n    const clientCtx = spec.clientCtx\r\n    const emiter = spec.emiter\r\n    const renderer = graphicsCtx.renderer\r\n    const resources = graphicsCtx.resources\r\n    const stage = graphicsCtx.stage\r\n    let selectedEditor\r\n    let selectedLayerEditor\r\n    let currentSet = 0\r\n    let sets = Object.getOwnPropertyNames(resources)\r\n\r\n    const editorContainer = new PIXI.Container()\r\n    editorContainer.position.x = 30\r\n    editorContainer.position.y = 10\r\n    editorContainer.visible = false\r\n    stage.addChild(editorContainer)\r\n\r\n    let newBoardButton\r\n    let saveBoardButton\r\n    let reloadBoardButton\r\n\r\n    let tileEditor\r\n    let obstacleEditor\r\n\r\n    let floorLayerButton\r\n    let middleLayerButton\r\n    let ceilingLayerButton\r\n\r\n    let tileSetUpButton\r\n    let tileSetDownButton\r\n\r\n    let tileSetPalette\r\n    let currentMarker\r\n    let currentTexId = 0\r\n\r\n    let clearTileEditor\r\n\r\n    const tileSetLabel = new PIXI.Text(`${sets[currentSet]} (${resources[sets[currentSet]].texture.width/16} x ${resources[sets[currentSet]].texture.height/16})`,\r\n        {font : '16px Arial', fill : 0xffffff, align : 'center'});\r\n    tileSetLabel.position.x = 226\r\n    tileSetLabel.position.y = 0\r\n    editorContainer.addChild(tileSetLabel)\r\n\r\n    const notificationLabel = new PIXI.Text('',{font : '16px Arial', fill : 0xffffff, align : 'center'});\r\n    notificationLabel.position.x = 10\r\n    notificationLabel.position.y = 330\r\n    notificationLabel.visible = false\r\n    editorContainer.addChild(notificationLabel)\r\n\r\n    const showNotification = (text)=>{\r\n        notificationLabel.text = text\r\n        notificationLabel.visible = true\r\n        setTimeout(()=>{\r\n            notificationLabel.text = ''\r\n            notificationLabel.visible = false\r\n        }, 2000)\r\n    }\r\n\r\n    tileSetUpButton = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: false,\r\n        frame: 8,\r\n        position : {\r\n            x : 190,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            currentSet++\r\n            if(currentSet >= sets.length){\r\n                currentSet = 0\r\n            }\r\n            tileSetLabel.text = `${sets[currentSet]} (${resources[sets[currentSet]].texture.width/16} x ${resources[sets[currentSet]].texture.height/16})`\r\n            tileSetPalette.setTileSet(sets[currentSet])\r\n        }\r\n    })\r\n\r\n    tileSetDownButton = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: false,\r\n        frame: 9,\r\n        position : {\r\n            x : 206,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            currentSet--\r\n            if(currentSet < 0){\r\n                currentSet = sets.length - 1\r\n            }\r\n            tileSetLabel.text = `${sets[currentSet]} (${resources[sets[currentSet]].texture.width/16} x ${resources[sets[currentSet]].texture.height/16})`\r\n            tileSetPalette.setTileSet(sets[currentSet])\r\n        }\r\n    })\r\n\r\n    floorLayerButton = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: true,\r\n        frame: 3,\r\n        position : {\r\n            x : 122,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            middleLayerButton.deselect()\r\n            ceilingLayerButton.deselect()\r\n            emiter.emit('r4two:editor:show-obstacles', false)\r\n            selectedLayerEditor = floorLayerButton\r\n        }\r\n    })\r\n\r\n    middleLayerButton = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: true,\r\n        frame: 4,\r\n        position : {\r\n            x : 140,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            floorLayerButton.deselect()\r\n            ceilingLayerButton.deselect()\r\n            emiter.emit('r4two:editor:show-obstacles', true)\r\n            selectedLayerEditor = middleLayerButton\r\n        }\r\n    })\r\n\r\n    ceilingLayerButton = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: true,\r\n        frame: 5,\r\n        position : {\r\n            x : 158,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            floorLayerButton.deselect()\r\n            middleLayerButton.deselect()\r\n            emiter.emit('r4two:editor:show-obstacles', false)\r\n            selectedLayerEditor = ceilingLayerButton\r\n        }\r\n    })\r\n\r\n    obstacleEditor = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: true,\r\n        frame: 1,\r\n        position : {\r\n            x : 64,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            tileEditor.deselect()\r\n            clearTileEditor.deselect()\r\n            floorLayerButton.hide()\r\n            middleLayerButton.hide()\r\n            ceilingLayerButton.hide()\r\n            tileSetDownButton.hide()\r\n            tileSetUpButton.hide()\r\n            tileSetLabel.visible = false\r\n            tileSetPalette.hide()\r\n            selectedEditor = obstacleEditor\r\n            emiter.emit('r4two:editor:show-obstacles', true)\r\n        }\r\n    })\r\n\r\n    tileEditor = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: true,\r\n        frame : 2,\r\n        position : {\r\n            x : 82,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            obstacleEditor.deselect()\r\n            clearTileEditor.deselect()\r\n            floorLayerButton.show()\r\n            middleLayerButton.show()\r\n            ceilingLayerButton.show()\r\n            tileSetDownButton.show()\r\n            tileSetUpButton.show()\r\n            tileSetLabel.visible = true\r\n            tileSetPalette.show()\r\n            selectedEditor = tileEditor\r\n            emiter.emit('r4two:editor:show-obstacles', false)\r\n        }\r\n    })\r\n\r\n    clearTileEditor = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: true,\r\n        frame: 13,\r\n        position : {\r\n            x : 100,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            obstacleEditor.deselect()\r\n            tileEditor.deselect()\r\n            floorLayerButton.hide()\r\n            middleLayerButton.hide()\r\n            ceilingLayerButton.hide()\r\n            tileSetDownButton.hide()\r\n            tileSetUpButton.hide()\r\n            tileSetLabel.visible = false\r\n            tileSetPalette.hide()\r\n            selectedEditor = clearTileEditor\r\n            emiter.emit('r4two:editor:show-obstacles', true)\r\n        }\r\n    })\r\n\r\n    newBoardButton = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: false,\r\n        frame: 9,\r\n        position : {\r\n            x : 0,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n        }\r\n    })\r\n\r\n    newBoardButton = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: false,\r\n        frame: 12,\r\n        position : {\r\n            x : 0,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n        }\r\n    })\r\n\r\n    saveBoardButton = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: false,\r\n        frame: 10,\r\n        position : {\r\n            x : 18,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            clientCtx.model.save().then((result) => {\r\n                showNotification(result)\r\n            })\r\n        }\r\n    })\r\n\r\n    reloadBoardButton = createEditorIcon({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: false,\r\n        frame: 11,\r\n        position : {\r\n            x : 36,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n        }\r\n    })\r\n\r\n    tileSetPalette = createTileSetPalette({\r\n        parent : editorContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        position : {\r\n            x : 0,\r\n            y : 20\r\n        },\r\n        tileset : sets[currentSet],\r\n        onClick : (id)=>{\r\n            currentTexId = id\r\n            currentMarker.texture = resources[sets[currentSet]].frames[id]\r\n        }\r\n    })\r\n\r\n    currentMarker = new PIXI.Sprite(resources[sets[currentSet]].frames[0])\r\n    currentMarker.position.x = 400\r\n    currentMarker.position.y = 0\r\n    editorContainer.addChild(currentMarker)\r\n\r\n\r\n    selectedEditor = obstacleEditor\r\n    selectedEditor.select()\r\n    floorLayerButton.hide()\r\n    floorLayerButton.select()\r\n    selectedLayerEditor = floorLayerButton\r\n    middleLayerButton.hide()\r\n    ceilingLayerButton.hide()\r\n    tileSetDownButton.hide()\r\n    tileSetUpButton.hide()\r\n    tileSetLabel.visible = false\r\n    tileSetPalette.hide()\r\n\r\n    emiter.on('r4two:action:editor',()=>{\r\n        editorContainer.visible = !editorContainer.visible\r\n        if(editorContainer.visible){\r\n            emiter.emit('r4two:editor:visible', true)\r\n            emiter.emit('r4two:editor:show-obstacles', selectedEditor === obstacleEditor)\r\n            clientCtx.model.setApplyLighting(false)\r\n        } else {\r\n            emiter.emit('r4two:editor:visible', false)\r\n            emiter.emit('r4two:editor:show-obstacles', false)\r\n            clientCtx.model.setApplyLighting(true)\r\n        }\r\n\r\n    })\r\n\r\n    const selectedLayer = ()=>{\r\n        if(selectedLayerEditor === floorLayerButton){\r\n            return 'floor'\r\n        } else if(selectedLayerEditor === middleLayerButton){\r\n            return 'middle'\r\n        } else if(selectedLayerEditor === ceilingLayerButton){\r\n            return 'ceiling'\r\n        }\r\n    }\r\n\r\n    emiter.on('r4two:board:tileselect', (tile)=>{\r\n        if(!editorContainer.visible) {\r\n            return\r\n        }\r\n        if(selectedEditor === obstacleEditor){\r\n            clientCtx.model.setTileObstacle({\r\n                position : {\r\n                    x : tile.position.x,\r\n                    y : tile.position.y\r\n                },\r\n                obstacle : !tile.obstacle\r\n            })\r\n        } else if(selectedEditor === tileEditor && currentTexId < resources[sets[currentSet]].frames.length){\r\n            clientCtx.model.setTileTex({\r\n                position : {\r\n                    x : tile.position.x,\r\n                    y : tile.position.y\r\n                },\r\n                layer : selectedLayer(),\r\n                newTex : sets[currentSet]+'_'+currentTexId\r\n            })\r\n        } else if(selectedEditor === clearTileEditor){\r\n            clientCtx.model.setTileTex({\r\n                position : {\r\n                    x : tile.position.x,\r\n                    y : tile.position.y\r\n                },\r\n                layer : 'floor',\r\n                newTex : 'floor_14'\r\n            })\r\n            clientCtx.model.setTileTex({\r\n                position : {\r\n                    x : tile.position.x,\r\n                    y : tile.position.y\r\n                },\r\n                layer : 'middle',\r\n                newTex : 'wall_5'\r\n            })\r\n            clientCtx.model.setTileTex({\r\n                position : {\r\n                    x : tile.position.x,\r\n                    y : tile.position.y\r\n                },\r\n                layer : 'ceiling',\r\n                newTex : 'wall_5'\r\n            })\r\n            clientCtx.model.setTileObstacle({\r\n                position : {\r\n                    x : tile.position.x,\r\n                    y : tile.position.y\r\n                },\r\n                obstacle : false\r\n            })\r\n        }\r\n    })\r\n\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/editor/createEditor.js\n ** module id = 17\n ** module chunks = 0\n **/","/**\r\n * Created by odrin on 21.09.2015.\r\n */\r\n'use strict'\r\n/*global PIXI */\r\n\r\nmodule.exports = function createEditorIcon(spec){\r\n    const graphicsCtx = spec.graphicsCtx\r\n    const resources = graphicsCtx.resources\r\n    const selectable = spec.selectable\r\n    const onClick = spec.onClick\r\n    const position = spec.position\r\n    const frame = spec.frame\r\n    const parent = spec.parent\r\n\r\n    const iconContainer = new PIXI.Container()\r\n    iconContainer.hitArea = new PIXI.Rectangle(0, 0, 16, 16);\r\n    iconContainer.interactive = true\r\n    iconContainer.buttonMode = true\r\n    iconContainer.position = position\r\n\r\n    const background = new PIXI.Sprite(resources.editor.frames[frame])\r\n    background.position.x = 0\r\n    background.position.y = 0\r\n    iconContainer.addChild(background)\r\n\r\n    const selected = new PIXI.Sprite(resources.editor.frames[0])\r\n    selected.position.x = 0\r\n    selected.position.y = 0\r\n    selected.visible = false\r\n    iconContainer.addChild(selected)\r\n\r\n    iconContainer.on('mousedown', ()=>{\r\n        if(selectable){\r\n            selected.visible = !selected.visible\r\n            onClick(selected.visible)\r\n        } else {\r\n            onClick()\r\n        }\r\n    })\r\n\r\n    parent.addChild(iconContainer)\r\n\r\n\r\n    return {\r\n        deselect : ()=>{\r\n            selected.visible = false\r\n        },\r\n        select : ()=>{\r\n            selected.visible = true\r\n        },\r\n        hide : ()=>{\r\n            iconContainer.visible = false\r\n        },\r\n        show : ()=>{\r\n            iconContainer.visible = true\r\n        }\r\n    }\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/editor/createEditorIcon.js\n ** module id = 18\n ** module chunks = 0\n **/","/**\r\n * Created by odrin on 21.09.2015.\r\n */\r\n'use strict'\r\n/*global PIXI */\r\n\r\nconst createEditorIcon = require('./createEditorIcon')\r\n\r\nmodule.exports = function createTileSetPalette(spec){\r\n    const graphicsCtx = spec.graphicsCtx\r\n    const resources = graphicsCtx.resources\r\n    const onClick = spec.onClick\r\n    const position = spec.position\r\n    const parent = spec.parent\r\n    let tileset = spec.tileset;\r\n\r\n    const tileSetPaletteContainer = new PIXI.Container()\r\n    tileSetPaletteContainer.position = position\r\n    parent.addChild(tileSetPaletteContainer)\r\n\r\n    let nextPaletteButton\r\n    let prevPaletteButton\r\n\r\n    let palette = []\r\n    let offset = 0\r\n    let offsetStep = 21\r\n\r\n\r\n\r\n    const update = ()=>{\r\n        palette.forEach((el, i)=>{\r\n            if(i+offset < resources[tileset].frames.length){\r\n                el.texture = resources[tileset].frames[i+offset]\r\n            } else {\r\n                el.texture = resources.wall.frames[5]\r\n            }\r\n        })\r\n    }\r\n\r\n    nextPaletteButton = createEditorIcon({\r\n        parent : tileSetPaletteContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: false,\r\n        frame: 6,\r\n        position : {\r\n            x : 400,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            offset = offset + offsetStep\r\n            update()\r\n        }\r\n    })\r\n\r\n    prevPaletteButton = createEditorIcon({\r\n        parent : tileSetPaletteContainer,\r\n        graphicsCtx : graphicsCtx,\r\n        selectable: false,\r\n        frame: 7,\r\n        position : {\r\n            x : 0,\r\n            y : 0\r\n        },\r\n        onClick : ()=>{\r\n            offset = offset - offsetStep\r\n            if(offset < 0){\r\n                offset = 0\r\n            }\r\n            update()\r\n        }\r\n    })\r\n\r\n    for(let i=0; i< offsetStep ; ++i){\r\n        let p\r\n        if(i < resources[tileset].frames.length){\r\n            p = new PIXI.Sprite(resources[tileset].frames[i])\r\n        } else {\r\n            p = new PIXI.Sprite(resources.wall.frames[5])\r\n        }\r\n        p.position.x = 20 + (i * (16 + 2))\r\n        p.position.y = 0\r\n        p.hitArea = new PIXI.Rectangle(0, 0, 16, 16);\r\n        p.interactive = true\r\n        p.buttonMode = true\r\n        p.on('mousedown', ()=>{\r\n            onClick(i + offset)\r\n        })\r\n        palette.push(p)\r\n        tileSetPaletteContainer.addChild(p)\r\n    }\r\n\r\n    return {\r\n        setTileSet : (ts)=>{\r\n            tileset = ts\r\n            offset = 0\r\n            update()\r\n        },\r\n        show : () =>{\r\n            tileSetPaletteContainer.visible = true\r\n        },\r\n        hide : ()=>{\r\n            tileSetPaletteContainer.visible = false\r\n        }\r\n    }\r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/editor/createTileSetPalette.js\n ** module id = 19\n ** module chunks = 0\n **/","/**\r\n * Created by odrin on 15.09.2015.\r\n */\r\n'use strict'\r\n\r\nmodule.exports = function createInterpreter(spec){\r\n\r\n    const clientCtx = spec.clientCtx\r\n    const model = clientCtx.model\r\n\r\n    const commands = new Map()\r\n    const Any = Symbol()\r\n\r\n    function isNumeric(n) {\r\n        return !isNaN(parseFloat(n)) && isFinite(n);\r\n    }\r\n\r\n    const validateFormat = (args,format)=>{\r\n        return format.every((el,i)=>{\r\n            if(el === Number){\r\n                return isNumeric(args[i])\r\n            }\r\n            if(el === String){\r\n                return args[i] !== undefined\r\n            }\r\n            if(el === Any){\r\n                return true\r\n            }\r\n        })\r\n    }\r\n\r\n    const getUseExample = (command, format) => {\r\n        return command + ' '+format.reduce((prev, curr)=>{return prev+' <'+(curr===Any?'?':curr.name)+'> '},\"\")\r\n    }\r\n\r\n    commands.set('help', {\r\n        format : [Any],\r\n        description : 'Prints help about given command or list of available commands.',\r\n        handler:(args)=> {\r\n            if (args.length === 0) {\r\n                const keys = [];\r\n                for (let key of commands.keys()) {\r\n                    keys.push(key)\r\n                }\r\n                return `You can use following commands: ${keys}. Type help <command> to find more information.`\r\n            } else if(args.length === 1 && commands.has(args[0])){\r\n                return getUseExample(args[0],commands.get(args[0]).format) +': '+ commands.get(args[0]).description\r\n            }\r\n        }\r\n    })\r\n\r\n    commands.set('createBoard', {\r\n        format : [String,Number,Number],\r\n        description : 'Creates new empty board with given name and dimensions.',\r\n        handler : (args)=>{\r\n            return model.createBoard({\r\n                name : args[0],\r\n                width : args[1],\r\n                height : args[2]\r\n            })\r\n        }\r\n    })\r\n\r\n    commands.set('loadBoard', {\r\n        format : [String],\r\n        description : 'Loads given board into current game.',\r\n        handler : (args)=>{\r\n            return model.loadBoard({\r\n                name : args[0],\r\n                width : args[1],\r\n                height : args[2]\r\n            })\r\n        }\r\n    })\r\n\r\n    commands.set('setTileTex', {\r\n        format : [Number, Number, String, String],\r\n        description : 'Set tile at given location, layer to new texture.',\r\n        handler : (args)=>{\r\n            return model.setTileTex({\r\n                position : {\r\n                    x : args[0],\r\n                    y : args[1]\r\n                },\r\n                layer : args[2],\r\n                newTex : args[3]\r\n            })\r\n        }\r\n    })\r\n\r\n    return {\r\n        interpret(command){\r\n            const comParts = command.split(' ')\r\n            const cmdDescr = commands.get(comParts[0])\r\n            if(cmdDescr) {\r\n                const args = comParts.slice(1,comParts.length)\r\n                if(validateFormat(args,cmdDescr .format)){\r\n                    return cmdDescr.handler(args)\r\n                } else {\r\n                    return commands.get('help').handler([comParts[0]])\r\n                }\r\n            }\r\n            return `Command '${comParts[0]}' not found! Type help to get list of commands.`\r\n        }\r\n    }\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/js/console/createInterpreter.js\n ** module id = 20\n ** module chunks = 0\n **/"],"sourceRoot":""}